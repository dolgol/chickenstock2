package util;

import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.request;

import java.util.ArrayList;
import java.util.List;

import javax.servlet.http.HttpServletRequest;

import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.jsoup.select.Elements;
import org.springframework.web.context.request.RequestContextHolder;
import org.springframework.web.context.request.ServletRequestAttributes;

import ssg.com.a.dto.stocksDto;

public class stockUtil {

private static String URL = "https://finance.naver.com/item/main.naver";
	
	public static void main(String[] args) throws Exception{
		
		/*
		 * HttpServletRequest request = ((ServletRequestAttributes) RequestContextHolder
		 * .getRequestAttributes()).getRequest();
		 * 
		 * List<stocksDto> list = (List)request.getAttribute("stockslist");
		 */

		String KEY_WORD = "009830";
		/*
		 * for(int i = 0; i < list.size(); i++){ stocksDto sk = list.get(i);
		 * 
		 * KEY_WORD = sk.getSymbol(); }
		 */
		
		System.out.println("URL :: " + URL + getParameter(KEY_WORD, 2));
		
		//1. document가져오기
		Document doc = Jsoup.connect(URL + getParameter(KEY_WORD, 2)).get();
		
		
		//2.목록가져오기
		/* System.out.println("" + doc.toString()); */
		
		Elements elements = doc.select("#middle .blind dd");
		
		// 3. 배열에서 정보를 가져온다.
		List<String> slist = new ArrayList<>();	
		for(Element element : elements) {
			slist.add(element.text());	
		}		
		System.out.println(slist);
	}
	/**
	* URL 완성
	*@Param KEY_WORD
	*@Param PAGE
	*@return
	*/
	public static String getParameter(String KEY_WORD, int PAGE) {
		
		
		return "?code=" + KEY_WORD + "" 
								 + "&itemTotalCnt:3"
								 + "&item_list:[,...]"
								 + "&login:'true'"
								 + "&next_page: 0"
								 + "&page: 1"
								 + "&prev_page:0"
								 + "&sel_cid:null"
								 + "&type:'recent'";
	}
}
